<form (ngSubmit)="handleAction(frm)" autocomplete="off" #frm="ngForm" class="add-product-container">
    <h3 class="mb-5 px-5">{{title}}</h3>
    <div class="border-bottom pb-3 mb-3 px-5">
      <div class="row">
        <div class="col-6">
          <label for="name" class="form-label mb-2">
            Name
          </label>
          <input #name="ngModel" type="text" class="form-control" id="name" name="name" 
            placeholder="Product"
            [(ngModel)]="product.name" 
            [ngClass]="{ 
              'is-invalid': name.invalid && name.touched,
              'is-valid': name.valid && name.touched
            }" 
            required 
          />
          @if (name.invalid) {
            <div *ngIf="name.invalid" class="invalid-feedback">
              Please add a valid name
            </div>
          }
        </div>
        <div class="col-6">
          <label for="description" class="form-label mb-2">
            Description
          </label>
          <input #description="ngModel" type="text" class="form-control" id="description" 
            name="description" 
            placeholder="Description"
            [(ngModel)]="product.description" 
            [ngClass]="{ 
              'is-invalid': description.invalid && description.touched,
              'is-valid': description.valid && description.touched
            }" 
            required 
          />
          @if (description.invalid) {
            <div *ngIf="description.invalid" class="invalid-feedback">
              Please add a valid description
            </div>
          }
        </div>

        <!-- Price -->
        <div class="col-6 pt-3">
          <label for="price" class="form-label mb-2">
            Price
          </label>
          <input #price="ngModel" type="price" class="form-control" id="price"    
            name="price" 
            placeholder="0.00"
            [(ngModel)]="product.price" 
            [ngClass]="{ 
              'is-invalid': price.invalid && price.touched,
              'is-valid': price.valid && price.touched
            }" 
            required 
          />
          @if (price.invalid) {
            <div *ngIf="price.invalid" class="invalid-feedback">
              Please add a valid price
            </div>
          }
        </div>

        <!-- STOCK -->
        <div class="col-6 pt-3">
          <label for="stock" class="form-label mb-2">
            Stock
          </label>
          <input #stock="ngModel" type="stock" class="form-control" id="stock"    
            name="stock" 
            placeholder="0.00"
            [(ngModel)]="product.stock" 
            [ngClass]="{ 
              'is-invalid': stock.invalid && stock.touched,
              'is-valid': stock.valid && stock.touched
            }" 
            required 
          />
          @if (stock.invalid) {
            <div *ngIf="stock.invalid" class="invalid-feedback">
              Please add a valid stock
            </div>
          }
        </div>

        <!-- Category -->

        <div class="col-6 pt-3">
          <label for="category" class="form-label mb-2">
            Category
          </label>

          <select #category="ngModel" type="category" class="form-control" id="category"    
          name="category" 
          placeholder="Category"
          [(ngModel)]="product.id_category"
          [ngClass]="{ 
            'is-invalid': category.invalid && category.touched,
            'is-valid': category.valid && category.touched
          }" 
          required >
            <!-- <option *ngFor="let cat of category_list"  value="{{cat.id}}" [selected]="cat.id === product.category?.id">{{cat.name}}</option> -->
            <option *ngFor="let cat of category_list"  value="{{cat.id}}">{{cat.name}}</option>
          </select>
          
          @if (category.invalid) {
            <div *ngIf="category.invalid" class="invalid-feedback">
              Please add a valid category
            </div>
          }
        </div>
        
        <!-- Category -->

        <!-- <div class="col-6 pt-3">
          <label for="category" class="form-label mb-2">
            Category
          </label>
          <input #category="ngModel" type="category" class="form-control" id="category"    
            name="category" 
            placeholder="Category"
            [(ngModel)]="product.category" 
            [ngClass]="{ 
              'is-invalid': category.invalid && category.touched,
              'is-valid': category.valid && category.touched
            }" 
            required 
          />
          
          @if (category.invalid) {
            <div *ngIf="category.invalid" class="invalid-feedback">
              Please add a valid category
            </div>
          }
        </div> -->


        @if(action == 'add') {
         
        }

        
      </div>
    </div>
    <div class="pb-3 mb-3 d-flex justify-content-center align-items-center">
      <button
        type="submit"
        class="btn btn-primary d-flex align-items-center">
        <i class="fa-solid white me-2"
          [ngClass]="{'fa-plus': action == 'add', 'fa-pencil':  action == 'edit'}"
        ></i>
        <p class="mb-0"> {{title}} </p>
      </button>
    </div>
    <div class="d-flex justify-content-center align-items-center">
      @if(feedbackMessage.message) {
        <p class="pb-0" [ngClass]="{
          'text-danger': feedbackMessage.type == 'ERROR',
          'text-success': feedbackMessage.type == 'SUCCESS'
          }">{{feedbackMessage.message}}</p>
      }
    </div>
  </form>